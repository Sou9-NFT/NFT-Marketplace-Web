{% extends 'base.html.twig' %}

{% block title %}{{ blog.title }}{% endblock %}

{% block body %}
<div class="container mt-5">
    {% for message in app.flashes('success') %}
        <div class="alert alert-success bg-dark text-success border-success alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="close text-success" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    {% endfor %}

    <div class="row">
        <div class="col-lg-8">
            <!-- Blog Post -->
            <article class="blog-post p-4 mb-4">
                <h1 class="display-4 mb-3 text-purple">{{ blog.title }}</h1>
                <div class="meta-info mb-4 d-flex align-items-center">
                    <span class="text-secondary mr-3">
                        <i class="far fa-calendar-alt text-purple"></i>
                        <span class="ml-1">{{ blog.date ? blog.date|date('F d, Y') : 'N/A' }}</span>
                    </span>
                    <span class="text-secondary">
                        <i class="far fa-comments text-purple"></i>
                        <span class="ml-1">
                            {{ blog.comments|length }} 
                            {% if blog.comments|length == 1 %}Comment{% else %}Comments{% endif %}
                        </span>
                    </span>
                </div>
                
                <div class="blog-content mb-4">
                    <div class="lead mb-4 text-secondary">
                        {{ blog.content|raw }}
                    </div>
                </div>

                <hr class="border-secondary my-4">

                <!-- Share Buttons -->
                <div class="share-buttons">
                    <span class="text-secondary mr-3">Share this post:</span>
                    <a href="#" class="btn btn-outline-purple btn-sm mr-2">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="btn btn-outline-purple btn-sm mr-2">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="btn btn-outline-purple btn-sm">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                </div>
            </article>

            <!-- Comments Section -->
            <section class="comments-section p-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="mb-0 text-purple">
                        <i class="far fa-comments"></i> Comments
                        <span class="badge badge-purple badge-pill ml-2">{{ blog.comments|length }}</span>
                    </h3>
                    <a href="{{ path('app_comment_new', {'blogId': blog.id}) }}" 
                       class="btn btn-outline-purple">
                        <i class="fas fa-plus-circle"></i> Add Comment
                    </a>
                </div>
                
                {% if blog.comments|length > 0 %}
                    {% for comment in blog.comments %}
                        <div class="comment mb-4">
                            <div class="card bg-darker">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <div>
                                            <i class="fas fa-user-circle text-purple"></i>
                                            <span class="font-weight-bold text-purple ml-2">{{ comment.author }}</span>
                                        </div>
                                        <small class="text-secondary">
                                            <i class="far fa-clock"></i>
                                            {{ comment.createdAt ? comment.createdAt|date('M d, Y H:i') : '' }}
                                        </small>
                                    </div>
                                    <p class="card-text mb-0 text-secondary">{{ comment.content }}</p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center py-5">
                        <i class="far fa-comment-dots text-secondary fa-3x mb-3"></i>
                        <p class="text-secondary mb-0">No comments yet. Be the first to comment!</p>
                    </div>
                {% endif %}
            </section>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <div class="position-sticky" style="top: 2rem;">
                <!-- Author Card -->
                <div class="card bg-dark mb-4">
                    <div class="card-body text-center">
                        <img src="https://via.placeholder.com/80" class="rounded-circle mb-3" alt="Author">
                        <h5 class="card-title mb-2 text-purple">Blog Author</h5>
                        <p class="text-secondary small mb-3">Passionate writer & content creator</p>
                        <div class="social-links">
                            <a href="#" class="text-secondary mx-2 hover-purple"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="text-secondary mx-2 hover-purple"><i class="fab fa-linkedin"></i></a>
                            <a href="#" class="text-secondary mx-2 hover-purple"><i class="fab fa-github"></i></a>
                        </div>
                    </div>
                </div>

                <!-- Actions Card -->
                <div class="card bg-dark">
                    <div class="card-body">
                        <h5 class="card-title mb-3 text-purple">Quick Actions</h5>
                        <div class="list-group list-group-flush">
                            <a href="{{ path('app_blog_index') }}" 
                               class="list-group-item list-group-item-action bg-transparent">
                                <i class="fas fa-arrow-left text-purple mr-3"></i>
                                <span class="text-secondary">Back to Posts</span>
                            </a>
                            <a href="{{ path('app_blog_edit', {'id': blog.id}) }}" 
                               class="list-group-item list-group-item-action bg-transparent">
                                <i class="fas fa-edit text-purple mr-3"></i>
                                <span class="text-secondary">Edit Post</span>
                            </a>
                            <a href="{{ path('app_comment_new', {'blogId': blog.id}) }}" 
                               class="list-group-item list-group-item-action bg-transparent">
                                <i class="fas fa-comment-dots text-purple mr-3"></i>
                                <span class="text-secondary">Add Comment</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block stylesheets %}
{{ parent() }}
<style>
    body {
        background-color: #121212;
        color: #e0e0e0;
    }
    .bg-dark {
        background-color: #1a1a1a !important;
    }
    .bg-darker {
        background-color: #141414 !important;
    }
    .blog-content {
        font-size: 1.1rem;
        line-height: 1.8;
    }
    .comment .card {
        transition: transform 0.2s ease;
    }
    .comment .card:hover {
        transform: translateX(5px);
    }
    .social-links a {
        transition: color 0.2s ease;
    }
    .social-links a:hover {
        color: #6f42c1 !important;
    }
    .share-buttons .btn {
        width: 38px;
        height: 38px;
        padding: 0;
        line-height: 36px;
        transition: all 0.2s ease;
    }
    .share-buttons .btn:hover {
        transform: translateY(-2px);
    }
    .list-group-item {
        transition: all 0.2s ease;
    }
    .list-group-item:hover {
        background-color: #2a2a2a !important;
        border-color: #6f42c1 !important;
    }
    .hover-purple:hover {
        color: #6f42c1 !important;
    }
    .text-purple {
        color: #6f42c1 !important;
    }
    .btn-outline-purple {
        color: #6f42c1;
        border-color: #6f42c1;
    }
    .btn-outline-purple:hover {
        color: #fff;
        background-color: #6f42c1;
        border-color: #6f42c1;
    }
    .badge-purple {
        color: #fff;
        background-color: #6f42c1;
    }
    .text-secondary {
        color: #888 !important;
    }
</style>
{% endblock %}
